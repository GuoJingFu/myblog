<!DOCTYPE html>
<html xmlns:v-bind="http://www.w3.org/1999/xhtml">
<head>
	<meta charset="utf-8">
	<title>文章列表--layui后台管理模板</title>
	<meta name="renderer" content="webkit">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<meta name="apple-mobile-web-app-status-bar-style" content="black">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="format-detection" content="telephone=no">
	<link rel="stylesheet" href="../../layui/css/layui.css" media="all" />
	<link rel="stylesheet" href="//at.alicdn.com/t/font_tnyc012u2rlwstt9.css" media="all" />
	<link rel="stylesheet" href="../../css/news.css" media="all" />
</head>
<body class="childrenBody">
	<blockquote class="layui-elem-quote news_search">
		<div class="layui-inline">
		    <div class="layui-input-inline">
		    	<input type="text" value="" placeholder="请输入关键字" class="layui-input search_input">
		    </div>
		    <a class="layui-btn search_btn">查询</a>
		</div>
		<div class="layui-inline">
			<a class="layui-btn layui-btn-normal newsAdd_btn">添加文章</a>
		</div>
		<div class="layui-inline">
			<a class="layui-btn recommend" style="background-color:#5FB878">推荐文章</a>
		</div>
		<div class="layui-inline">
			<a class="layui-btn audit_btn">审核文章</a>
		</div>
		<div class="layui-inline">
			<a class="layui-btn layui-btn-danger batchDel">批量删除</a>
		</div>
		<div class="layui-inline">
			<div class="layui-form-mid layui-word-aux">本页面刷新后除新添加的文章外所有操作无效，关闭页面所有数据重置</div>
		</div>
	</blockquote>
	<div class="layui-form news_list">
	  	<table class="layui-table">
		    <colgroup>
				<col width="50">
				<col>
				<col width="9%">
				<col width="9%">
				<col width="9%">
				<col width="9%">
				<col width="9%">
				<col width="15%">
		    </colgroup>
		    <thead>
				<tr>
					<th><input type="checkbox" name="" lay-skin="primary" lay-filter="allChoose" id="allChoose"></th>
					<th style="text-align:left;">文章标题</th>
					<th>文章分类</th>
					<th>浏览权限</th>
					<th>发布时间</th>
					<th>操作</th>
				</tr> 
		    </thead>
			<form>
				<tbody class="news_content" id="articlelist">
					<template v-for="article in articles">
						<tr>
							<td><input :value="article.id" type="checkbox" name="delect_id" lay-skin="primary"></td>
							<td>{{article.title}}</td>
							<td>{{article.clazz}}</td>
							<td>{{article.status}}</td>
							<td>{{article.time.time | time}}</td>
							<td>
								<a v-bind:href="'article-update.html?id=' + article.id"><span class="layui-icon">&#xe642;</span></a>
								<a><span class="layui-icon">&#xe600;</span></a>
								<a v-bind:href="'article-info.html?id='+article.id"><span class="layui-icon">&#xe62a;</span></a>
							</td>
						</tr>
					</template>
				</tbody>
			</form>

		</table>
	</div>
	<div id="page"></div>
	<script type="text/javascript" src="../../layui/layui.js"></script>
	<script type="text/javascript" src="newsList.js"></script>
	<!--<script type="text/javascript" src="../../js/vue.min.js"></script>-->
	<script src="https://cdn.bootcss.com/vue/2.4.2/vue.js"></script>
	<script type="text/javascript" src="https://cdn.bootcss.com/jquery/3.0.0-beta1/jquery.js"></script>
	<script>

		//事件过滤器
        Vue.filter('moment', function (value, formatString) {
            formatString = formatString || 'YYYY-MM-DD HH:mm:ss';
            return moment(value).format(formatString);
        });

		function getArticles(){
		    $.ajax({
				url: "../../articlelist?id=1",
				type: "get",
				dataType: "json",
				success: function (result) {
                    writeArticles(result);
                }
			})
		}
        function goodTime(str){
            var now = new Date().getTime(),
                oldTime = new Date(str).getTime(),
                difference = now - oldTime,
                result='',
                minute = 1000 * 60,
                hour = minute * 60,
                day = hour * 24,
                halfamonth = day * 15,
                month = day * 30,
                year = month * 12,

                _year = difference/year,
                _month =difference/month,
                _week =difference/(7*day),
                _day =difference/day,
                _hour =difference/hour,
                _min =difference/minute;
            if(_year>=1) {result= "发表于 " + ~~(_year) + " 年前"}
            else if(_month>=1) {result= "发表于 " + ~~(_month) + " 个月前"}
            else if(_week>=1) {result= "发表于 " + ~~(_week) + " 周前"}
            else if(_day>=1) {result= "发表于 " + ~~(_day) +" 天前"}
            else if(_hour>=1) {result= "发表于 " + ~~(_hour) +" 个小时前"}
            else if(_min>=1) {result= "发表于 " + ~~(_min) +" 分钟前"}
            else result="刚刚";
            return result;
        }
		function writeArticles(data) {
            Vue.filter('time', function (value) {
                return goodTime(value);
            })
            var vue = new Vue({
                el: "#articlelist",
				data: data.data
            })
        }
        getArticles();



	</script>
</body>
</html>